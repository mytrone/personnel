<template>
	<el-row class="JNPF-common-search-box" :gutter="16">
		<el-form @submit.native.prevent>
			<el-col :span="12">
				<el-form-item label="流程名称">
					<el-input v-model="query.name" placeholder="请输入" clearable> </el-input>
				</el-form-item>
			</el-col>
			<el-col :span="12">
				<el-form-item label="日期">
					<el-date-picker v-model="query.arrivalDate" type="daterange" value-format="timestamp"
						format="yyyy-MM-dd" start-placeholder="开始日期" end-placeholder="结束日期">
					</el-date-picker>

				</el-form-item>
			</el-col>
			<el-col :span="12">
				<el-form-item>
					<el-button type="primary" icon="el-icon-search" @click="search()">查询</el-button>
				</el-form-item>
			</el-col>



		</el-form>
	</el-row>
	<el-table :data="tableData" style="width: 100%">
		<el-table-column label="编号" width="100">
			<template #default="scope">

				<span style="margin-left: 10px">{{ scope.row.approveId }}</span>
			</template>
		</el-table-column>
		
		<el-table-column label="所属流程" width="180">
			<template #default="scope">
				<el-popover effect="light" trigger="hover" placement="top">

					<template #reference>
						<div class="name-wrapper">
							<el-tag size="medium">{{ scope.row.approve_flow.flowName }}</el-tag>
						</div>
					</template>
				</el-popover>
			</template>
		</el-table-column>
		<el-table-column label="发起时间" width="180">
			<template #default="scope">

				<span>{{ scope.row.approveTime }}</span>
			</template>
		</el-table-column>
		<el-table-column label="发起人" width="100">
			<template #default="scope">

				<span style="margin-left: 10px">{{ scope.row.archivesEmpsq.empName }}</span>
			</template>
		</el-table-column>
		<el-table-column label="当前节点" width="150">
			<template #default="scope">

				<span style="margin-left: 10px">{{ scope.row.workflowNode.alinkey.alinkeyName }}</span>
			</template>
		</el-table-column>
		<el-table-column label="流程进度" width="130">
			<template #default="scope">
				<span style="margin-left: 10px">{{scope.row.approveState?"已结束":"进行中"  }}</span>
			</template>
		</el-table-column>
		<el-table-column label="Operations">
			<template #default="scope">
				<el-button size="mini" @click="handleEdit(scope.$index, scope.row)">详情</el-button>
				<template v-if="scope.row.approveState==0">
					<el-button size="mini" @click="rowClick(scope.$index, scope.row)">审批</el-button>
				</template>
				
			</template>
		</el-table-column>
	</el-table>


 
	<el-drawer v-model="drawer" title="审批" size="30%">
		
		<el-col>
			<el-row>
				<el-col :span="24">
					<div class="grid-content bg-purple">
						<div class="mstz">流程审批</div>
					</div>
				</el-col>
				<div class="spstate" v-if="ins=='1'">
					<svg t="1634537166539" class="icon" viewBox="0 0 1358 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="3566" width="100" height="100">
						<path
							d="M677.761611 202.221641c101.559586 0 191.634869 49.160159 247.787602 124.976957l39.287331 10.529657C906.195205 240.456414 799.580894 175.405896 677.761611 175.405896a333.338518 333.338518 0 0 0-162.195888 41.86569l39.217976 10.513338a306.983777 306.983777 0 0 1 122.969753-25.563283h0.008159z m202.405228-17.444717l21.516239 17.444717 6.625402-26.146677 24.090518-14.08306-24.090518-14.07898-6.625402-26.150757-21.516239 17.448797-28.186518-2.080637 10.790757 24.861577-10.778518 24.873817 28.182438-2.088797h-0.008159z m-373.237801-58.527107l-22.124112-15.408956-4.834422 27.293067L457.320113 155.027888l24.429132 11.725004 8.126725 25.848861 19.921084-20.047554 27.668398-0.917928-12.104414-24.110916 8.979378-26.424096-27.415458 5.144478z m207.178454-37.688096l-16.396239-21.418327-12.895873 24.522965-26.713753 9.220079 19.7171 18.582948-0.114231 27.105403 25.077801-13.030502 26.640318 7.539251-4.21431-26.640319 16.587984-22.454566-27.688797-3.426932z m299.889211 168.380685l-23.237864-16.086183-3.304542 26.909578-21.89565 15.943394 25.34706 12.504223 9.697402 25.963092 18.970518-19.174502 27.892781 0.081594-13.617976-24.355698 7.527012-25.897816-27.378741 4.112318z m301.790343 202.654088l-1165.034582-312.381195c-28.602645-7.661641-57.996749 9.317992-65.654311 37.916558l-0.004079 0.016318-83.245897 310.871713c-7.661641 28.606725 9.301673 58.013068 37.904319 65.699188l1165.030502 312.360797c28.590406 7.669801 57.98451-9.289434 65.654311-37.879841l0.008159-0.032638 83.233657-310.883952c7.669801-28.598566-9.293514-58.008988-37.892079-65.682868z m8.546932 71.704478l-76.302279 284.965737c-5.736032 21.450964-27.77855 34.187729-49.229514 28.451697h-0.008159L59.632783 539.293068c-21.450964-5.76051-34.17549-27.815267-28.431299-49.270311l76.310438-284.973896c5.744191-21.446884 27.790789-34.183649 49.241753-28.435379l1139.140845 305.417179c21.459124 5.75643 34.187729 27.823426 28.431299 49.28255l0.008159-0.012239zM677.761611 27.892781c223.289116 0 411.101323 151.772303 466.111745 357.841084l29.663363 7.951298C1120.700767 168.625466 918.797341 1.068876 677.769771 1.068876c-146.154582 0-277.907888 61.611347-370.777753 160.274359l29.618486 7.94314C423.923843 81.928159 544.547779 27.892781 677.761611 27.892781z m123.01055 765.629705a306.934821 306.934821 0 0 1-123.00239 25.559203c-101.551426 0-191.622629-49.14792-247.787602-124.972876l-39.283251-10.533737c58.653578 97.271841 165.267888 162.322359 287.083092 162.322358a333.342598 333.342598 0 0 0 162.208127-41.865689l-39.217976-10.509259z m-287.584892 55.687649l-21.336733-17.40392-6.580526 26.085482-23.874295 14.050423 23.874295 14.038183 6.584605 26.097721 21.332654-17.40392 27.958056 2.080637-10.696925-24.812621 10.696925-24.808542-27.958056 2.076557z m164.492749 82.605387l16.273848 21.37753 12.785722-24.482168 26.49345-9.179282-19.553913-18.554391 0.114231-27.040127-24.869737 13.014183-26.436334-7.531092 4.185753 26.587283-16.445195 22.39745 27.464414 3.410614h-0.012239z m-338.81753-168.57243l21.854853 17.648701 5.164876-26.538327 22.793179-14.348239-24.19251-14.225849-7.767713-26.509768-20.116908 17.754772-27.599044-2.03984 11.765801 25.192032-9.285355 25.245067 27.39098-2.182629h-0.012239z m338.911363 230.175617c-223.268717 0-411.080924-151.780462-466.111746-357.849243l-29.655203-7.951299c52.831873 225.059697 254.743458 392.616287 495.762869 392.616287 146.154582 0 277.920127-61.603187 370.781833-160.274358l-29.622566-7.94314c-87.317418 87.358215-207.933195 141.401753-341.167427 141.401753h0.01224z m193.764462-98.414151l21.989482 15.396717 4.73243-27.195155 22.458645-16.816447-24.274103-11.729083-8.106327-25.783586-19.741578 19.949641-27.464414 0.889371 12.055458 24.045641-8.844749 26.334343 27.195156-5.091442z"
							fill="#03BF50" opacity=".5" p-id="3567">
						</path>
						<path
							d="M198.668321 401.134661l-5.63812 21.034837 48.099442 12.887713 5.63404-21.034836-48.099442-12.891793z m36.080701 57.711172l-48.099442-12.875474-3.484048 13.022342-25.551044-6.853864 33.832797-126.237578 73.646406 19.737498 5.491251-20.541195 26.056924 6.976255-5.50349 20.541195 74.388909 19.933323-33.624733 125.490996-25.551044-6.841626 3.292303-12.27984-48.850104-13.087618-13.218167 49.343745-26.044685-6.976255 13.218167-49.351904z m32.421227-16.808287l48.850104 13.087617 5.638119-21.047075-48.850104-13.083538-5.638119 21.047075z m60.583267-30.752638l5.784988-21.540717-48.850104-13.079458-5.76051 21.540717 48.837865 13.091697-0.008159-0.012239zM258.639635 369.680319l-48.087203-12.879554-5.76051 21.540717 48.087203 12.887713 5.76051-21.548876zM398.988831 323.804303l-13.014184 48.589004-25.551043-6.849785 6.6458-24.788144-164.317322-44.02384-6.976255 26.044685-25.551044-6.853864L183.589819 266.076813l92.9229 24.894215a195.016924 195.016924 0 0 0-2.68443-16.016829l29.006534 2.94145c0.522199 6.050167 0.852653 12.859155 0.979123 20.398407l95.174885 25.510247z m81.348844 126.217179l-31.60937 117.984383-25.302184-6.79267 29.728638-110.955091c-12.312478 17.909801-25.46945 33.975586-40.054311 48.323824l-3.777785-30.001976c22.075155-18.248414 40.825371-41.143586 56.120096-68.175554l-30.801594-8.261354 6.641721-24.788144 31.813355 8.514295 12.345115-46.08 25.302184 6.772271-12.341036 46.07592 26.795347 7.192479-6.649881 24.788143-26.803506-7.168-3.426932 12.773482a632.583139 632.583139 0 0 1 23.135872 49.947538l-20.818613 18.587028c-3.957291-15.294725-7.200637-28.243633-10.297116-38.736574z m54.626932-80.663458l58.11914 15.576223a185.08698 185.08698 0 0 0-4.948653-23.609116l28.011091 2.676271c1.232064 8.383745 1.954167 17.701737 2.488606 27.770391l54.104733 14.503267-6.380622 23.792701-68.636557-18.391203c-16.88988 16.951076-31.115729 28.986135-42.820335 36.586581 12.981546 2.676271 26.024287 5.091442 38.810008 7.445419a250.427155 250.427155 0 0 0 23.531601-22.687108l18.024032 16.910279c-38.410199 43.126311-84.041434 67.143394-137.216 72.226677l-8.497976-25.367458c29.283952-2.084717 55.834518-10.007458 79.716972-24.004844l-49.200956-10.770359 0.38349-22.442327a17.485514 17.485514 0 0 0 5.368861-0.987283c10.23592-3.157673 25.408255-14.670534 45.104956-34.089816l-42.326693-11.333355 6.376542-23.80494h-0.00816z m38.593785 181.623331c-28.79847 14.295203-60.077386 22.833976-93.518534 25.404175l-8.559171-26.179315c62.892367-3.288223 115.956781-27.994773 158.879108-73.944223l18.762454 17.114263c-17.28153 18.456478-35.660494 33.926629-55.051219 46.181992 12.630693 18.962359 23.205227 37.63098 31.331952 55.373514l-24.143554 13.936191c-5.984892-17.709896-15.094821-36.790566-27.701036-57.890677z m172.664351-149.446885c12.969307 17.705817 23.686629 34.807841 31.719522 50.914422l-23.111395 13.136574c-6.417339-15.139697-16.755251-32.670088-30.887266-52.036335l22.275059-12.014661z m82.287171 263.93906c-13.764845-3.704351-28.729116-7.971697-44.692908-12.520542-16.212653-4.618199-29.088127-9.668845-38.932399-14.996908-9.22008-5.687076-16.441116-13.801562-21.671266-24.32306-2.366215-5.205673-4.834422-8.016574-7.592287-8.746837-5.009849-1.346295-16.481912 7.396462-35.044462 26.579124l-14.515506-22.948207c17.897562-16.681817 32.331474-26.505689 43.832095-29.332909l18.391203-68.628398-33.061737-8.852909 6.441817-24.0538 57.352159 15.368159-25.510247 95.187124 2.027602 3.496286c4.010327 8.045131 8.432701 14.605259 13.577179 19.472319 6.254151 5.699315 16.734853 10.656127 31.372749 15.119299a2992.348303 2992.348303 0 0 0 50.718598 14.123856c12.528701 3.353498 25.118598 6.458135 38.14502 9.946263 9.864669 2.276462 19.766056 4.397896 29.70008 6.356144l-13.165132 24.123155-57.360319-15.368159h-0.012239z m9.032415-211.009275l-47.336542-12.687809 5.76051-21.540717 138.517418 37.108781-4.895617 18.289211a271.282486 271.282486 0 0 1-54.484144 18.958279l0.371251 0.63643 50.596207 13.556781-29.724557 110.967331c-4.165355 15.531347-14.833721 21.259219-31.866391 16.694056l-18.782853-5.042486 0.00816-23.070598 17.077546 5.3811c5.511649 1.468685 9.007936-0.546677 10.419506-5.801307l2.81498-10.525578-33.559458-8.987538-10.872351 40.57651-24.049721-6.445896 10.87235-40.58059-32.555856-8.722358-10.941705 40.837609-24.543363-6.584605 36.443793-136.016574 55.606056 14.907155a453.12612 453.12612 0 0 0-21.642709-22.442326l16.76749-9.464861z m25.004366 23.874295a257.387092 257.387092 0 0 0 30.858709-8.905944l-50.094406-13.422152c7.025211 7.784032 13.638375 15.192733 19.235697 22.328096z m-66.81702 58.074263l-4.230629 15.780207 32.555856 8.722358 4.238789-15.780207-32.564016-8.722358z m56.601498 15.164175l-4.21839 15.776128 33.555378 9.003856 4.22655-15.780207-33.563538-8.999777z m39.201658-12.047299l4.226549-15.776127-33.563537-8.991618-4.218391 15.780207 33.555379 8.987538z m-57.6051-15.429354l4.21839-15.788367-32.555856-8.722358-4.22655 15.780207 32.568096 8.722358v0.00816z m181.558056-50.420781c13.291602 17.526311 24.151713 34.130614 32.433466 50.30247l-24.139474 13.936191c-6.409179-15.143777-16.502311-32.608892-30.642486-51.96698l22.348494-12.271681z m89.067601 265.750438c-14.278884-3.826741-29.736797-8.228717-46.451251-12.981546-16.971474-4.814024-30.58945-10.076813-40.690741-15.470151-9.966661-5.895139-17.444717-14.0749-22.670789-24.592319-2.366215-5.205673-5.336223-8.147124-8.342948-8.950821-5.009849-1.338135-16.869482 7.828908-35.815522 27.456255l-14.523665-22.960446c18.032191-17.175458 33.041339-27.113562 44.537881-29.94486l18.391203-68.624319-33.563538-9.003857 6.584605-24.539283 58.351682 15.633339-25.510247 95.187124c0.742502 1.264701 1.546199 2.284622 2.276462 3.557482 4.267347 8.126725 9.183363 14.809243 14.32784 19.676302 6.817147 5.589163 17.742534 10.925386 33.127012 15.596622a3367.205737 3367.205737 0 0 0 52.974662 14.727649c11.52102 3.088319 23.352096 5.988972 35.44835 8.950821 12.15745 2.725227 21.557036 4.707952 27.953976 5.89106l-13.30792 24.616797-53.097052-14.225849z m1.860335-36.011347l-35.07302-9.391426 0.954646-26.599522c10.762199 3.957291 21.324494 7.588207 31.344191 10.284877 6.511171 1.750183 10.962104-0.820016 12.704127-7.343427l25.905976-96.688446-93.681721-25.098199 6.853865-25.538805 93.669482 25.098199 10.072733-37.573864 26.052845 6.984414-10.076813 37.573865 34.824159 9.330231-6.849785 25.538805-34.820079-9.317992-27.648 103.187378c-4.760988 17.79557-16.196335 24.376096-34.228526 19.553912z m-29.271713-129.191267c10.182884 22.062916 17.673179 41.245578 22.319936 56.984989l-24.943171 8.893705c-4.630438-16.808287-11.467984-36.35812-21.022598-58.792287l23.645833-7.086407z"
							fill="#03BF50" opacity=".5" p-id="3568"></path>
					</svg>
				</div>
				<div class="spstate" v-if="ins=='-1'">
					<svg t="1634537251164" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="5325" width="100" height="100">
						<path
							d="M1016.769409 369.245917L860.442782 121.971124c-12.845444-20.48-40.96-26.599763-64.045444-14.299645l-775.573965 490.7929a48.473373 48.473373 0 0 0-14.360236 63.984852l155.114792 244.729941a48.473373 48.473373 0 0 0 64.045444 14.360236L1001.379113 430.201183a43.989586 43.989586 0 0 0 15.390296-60.955266z m-32.234793 35.870296L208.839468 896.757396c-6.665089 5.089704-15.390296 1.514793-20.48-5.150295L33.729409 647.301302a14.239053 14.239053 0 0 1 4.120236-20.48l775.573965-491.52c6.665089-5.150296 15.390296-1.575385 20.48 5.089704l156.205444 244.245207a15.087337 15.087337 0 0 1-5.63503 20.48zM308.694616 219.766154l-2.605444-33.264852 28.175148 18.177515 30.72-14.360237L357.531539 222.311006l22.055385 25.630296-34.840237 2.544852L329.174616 278.721893l-12.845444-30.780591-32.234793-6.665089c-1.030059 1.514793 24.600237-21.510059 24.600237-21.510059z m175.715976-61.44l14.360237-30.72 15.329704 28.175148 33.264852 2.544852-21.994793 24.600237 6.665089 33.264852-30.72-14.360237-28.175148 18.177515 5.150296-33.264852-25.630296-22.055385c-2.181302-0.242367 31.144142-6.36213 31.628876-6.36213z m230.248521 655.36l2.605444 33.264852-28.175148-17.874556-30.72 12.784852 7.695148-32.295385-22.055385-25.569704 33.325444-2.544852 18.177515-28.175148 12.845443 30.72 32.234793 6.665089-25.630296 23.024852z m-175.715976 59.925207l-15.329705 30.72-15.390295-28.175148-33.264853-2.544852 24.236687-24.600237-6.604497-32.234793 30.72 14.299645 28.114556-15.329704-5.089704 33.264852 24.236686 21.994793c-0.484734-3.574911-32.234793 2.605444-32.234793 2.605444zM189.874261 358.03645l-19.449941-27.145089 33.264852 1.514793L224.229764 305.261065l9.209941 32.295385 32.295384 11.754793-27.145089 19.44994v33.264853L212.899113 381.727811l-32.234793 9.20994c-2.544852-1.211834 8.725207-32.901302 9.209941-32.901301z"
							fill="#F04134" opacity=".5" p-id="5326">
						</path>
						<path
							d="M287.184557 160.871006a415.356213 415.356213 0 0 1 412.023668-18.904615l30.72-19.449941a440.865325 440.865325 0 0 0-120.335148-46.110296 449.408757 449.408757 0 0 0-171.535148-5.089704 425.172071 425.172071 0 0 0-166.263668 63.984852c-51.2 33.264852-94.704852 72.710059-127.969704 122.88a452.862485 452.862485 0 0 0-69.135148 157.174911 434.624379 434.624379 0 0 0-8.725207 127.969704L96.98716 523.875976a400.390059 400.390059 0 0 1 190.197397-363.00497z m446.439763 704.015148A414.810888 414.810888 0 0 1 322.509527 884.639053l-30.72 19.449941A440.865325 440.865325 0 0 0 412.064083 949.896331a443.894911 443.894911 0 0 0 337.92-58.895148 418.506982 418.506982 0 0 0 127.969704-122.88 454.43787 454.43787 0 0 0 68.105089-157.538461 432.685444 432.685444 0 0 0 9.209941-127.969704L927.093669 501.881183a417.234556 417.234556 0 0 1-193.529941 363.004971z"
							fill="#F04134" opacity=".5" p-id="5327">
						</path>
						<path
							d="M380.374616 306.83645a248.426036 248.426036 0 0 1 115.12426-37.385089l47.625089-30.72a271.450888 271.450888 0 0 0-179.230296 40.96 281.993846 281.993846 0 0 0-114.094201 143.36l47.625089-30.72a227.097751 227.097751 0 0 1 82.950059-85.494911z m261.089704 412.023668a249.577278 249.577278 0 0 1-115.12426 37.385089L478.714971 787.086391a272.662722 272.662722 0 0 0 179.230296-40.96 282.47858 282.47858 0 0 0 114.154793-143.36l-47.625089 30.72a269.390769 269.390769 0 0 1-82.950059 85.494911zM416.063137 649.240237c8.301065-5.271479 12.72426-10.421775 13.148402-15.450888s-2.544852-13.693728-8.967574-26.47858a67.741538 67.741538 0 0 0 24.236686-4.907929q12.118343 25.448521 9.331125 38.172781c-1.938935 9.028166-10.179408 18.177515-24.842604 27.448048l-54.168994 34.416094q-23.873136 15.147929-36.35503 14.360237t-24.539645-19.146982l-48.473372-76.284971 20.116449-12.784852 14.178462 22.297752 74.285444-47.200947-22.115977-34.840237-100.764023 64.106036-12.118344-19.328758 121.183432-77.012071 51.381776 81.071716-20.298225 12.906036-4.847338-7.695148-74.346035 47.140355 22.115976 34.658462c3.211361 5.029112 6.483314 7.452781 9.937042 7.271005a52.714793 52.714793 0 0 0 18.177514-8.906982zM577.358284 465.829112a158.568521 158.568521 0 0 1 3.999054 56.956213 125.243077 125.243077 0 0 0 46.292071 0 69.498698 69.498698 0 0 0-3.393136 24.660829 133.301775 133.301775 0 0 1-47.806864-2.12071A156.144852 156.144852 0 0 1 551.42503 593.253491a118.153846 118.153846 0 0 0-17.026272-8.301065 25.630296 25.630296 0 0 1 1.999526 11.815385 21.388876 21.388876 0 0 1-8.48284 14.117869 177.776095 177.776095 0 0 1-19.025799 12.118344 40.172308 40.172308 0 0 0-14.784378-12.118344c6.059172-3.211361 12.118343-6.422722 17.026272-9.694674a8.604024 8.604024 0 0 0 4.302012-5.453255q1.272426-7.452781-21.510059-47.68568L450.661006 575.621302q-12.118343-26.296805-32.113609-60.591716L436.30077 505.092544q11.754793 20.358817 23.448994 43.444261L474.049409 539.266272q-11.209467-23.873136-29.023432-55.562603L406.004912 508.970414l-10.421775-16.359763 56.471479-35.870296q27.266272 47.988639 38.536331 72.285917l11.088284-7.089231 4.180829 7.271006a541.568757 541.568757 0 0 1 26.539171 50.897042 128.696805 128.696805 0 0 0 22.964261-41.262959 206.55716 206.55716 0 0 1-48.473373-27.690414L521.129172 495.216095a154.084734 154.084734 0 0 0 38.83929 21.752426 110.095148 110.095148 0 0 0-4.24142-43.201894zM502.951657 578.650888q-5.150296 5.513846-33.507219 34.355503L456.962545 599.857988q8.785799-7.937515 35.627929-34.355503z m65.31787-114.39716a261.392663 261.392663 0 0 0-39.505799-3.635503 209.526154 209.526154 0 0 1-23.812544 44.959053 116.15432 116.15432 0 0 0-23.146036-6.422722A164.870059 164.870059 0 0 0 505.678284 460.497041c-12.118343 0-23.630769 0.908876-35.022011 1.999527L474.473551 442.319527c12.72426-1.454201 25.630296-2.302485 38.83929-2.544852a110.458698 110.458698 0 0 0 4.120236-32.537752l22.540119-5.089704a157.538462 157.538462 0 0 1-4.665562 37.627456c13.451361 0.36355 25.387929 1.090651 35.930887 2.241893zM700.601835 295.324024l93.493018 147.298461-21.267693 13.511953-5.513846-8.664616-98.400947 62.47006 5.513846 8.664615-19.995266 12.845444L560.634971 384.151479z m55.199053 133.968284L691.997811 328.770651 593.839231 391.24071l63.803077 100.521657zM688.362308 358.157633l39.505799 62.227692-66.650888 42.414202-39.445207-62.227693zM679.515918 387.786982l-28.781065 18.177515 18.177514 28.296331 28.841657-18.177514z"
							fill="#F04134" opacity=".5" p-id="5328"></path>
					</svg>
				</div>
				<div class="spstate" v-if="ins=='0'">
					<svg t="1634537221225" class="icon" viewBox="0 0 1300 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="4404" width="100" height="100">
						<path
							d="M784.014714 99.204787l10.903312 18.428134-21.294732-2.559463-14.179425 16.124617-4.095141-21.089976-19.707865-8.497417 18.735269-10.442609 2.04757-21.345922 15.715103 14.58894 20.936408-4.658223-9.060499 19.451919zM1067.142514 642.37403l-18.428134 10.903312 2.559463-21.294732-16.073428-14.179425 21.038786-4.14633 8.497417-19.656676 10.442609 18.735269 21.345922 1.996381-14.588939 15.715103 4.658222 20.936408-19.451918-9.00931z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4405">
						</path>
						<path
							d="M1067.142514 642.37403l-18.428134 10.903312 2.559463-21.294732-16.073428-14.179425 21.038786-4.14633 8.497417-19.656676 10.442609 18.735269 21.345922 1.996381-14.588939 15.715103 4.658222 20.936408-19.451918-9.00931zM571.886418 100.023815l-17.404348-12.541369 20.526893-6.1939 6.501036-20.424515 12.234233 17.609105 21.448301-0.153567-12.950883 17.097213 6.756982 20.373325-20.270947-7.012928-17.250781 12.694936 0.409514-21.4483zM991.382408 784.373039l-21.192354 3.480869 10.135474-18.888837-9.828338-19.093594 21.089975 3.788005 15.100832-15.254399 2.917788 21.243543 19.144783 9.623581-19.298351 9.367634-3.224923 21.192354-14.844886-15.459156zM427.993407 156.792705l-20.78284-5.323683 16.892456-13.258019-1.330921-21.397111 17.762674 11.927098 19.963811-7.883146-5.886765 20.629272 13.667533 16.534131-21.397111 0.819028-11.517584 18.069809-7.371253-20.117379zM854.19519 896.42633l-20.731651-5.323683 16.841267-13.258019-1.330921-21.397111 17.813863 11.978287 19.912622-7.934335-5.835575 20.629272 13.667532 16.534131-21.4483 0.819028-11.517584 18.069809-7.371253-20.117379zM562.416405 923.607827l10.903313 18.428134-21.294733-2.559463-14.179425 16.073428-4.14633-21.038786-19.656676-8.497418 18.735269-10.442609 1.996381-21.345921 15.715103 14.588939 20.936408-4.658223-9.00931 19.451919zM242.790663 420.724532l-18.479324 10.954502 2.559464-21.294733-16.073428-14.230614 21.038786-4.095141 8.497417-19.707865 10.442609 18.735269 21.345922 2.047571-14.588939 15.715103 4.709412 20.936407-19.451919-9.060499z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4406">
						</path>
						<path
							d="M242.790663 420.724532l-18.479324 10.954502 2.559464-21.294733-16.073428-14.230614 21.038786-4.095141 8.497417-19.707865 10.442609 18.735269 21.345922 2.047571-14.588939 15.715103 4.709412 20.936407-19.451919-9.060499zM700.780976 943.878774l-17.404348-12.490179 20.475704-6.24509 6.552225-20.424515 12.234233 17.609106 21.448301-0.102379-12.950883 17.097213 6.756982 20.322136-20.270947-7.012928-17.30197 12.694936 0.460703-21.4483zM303.552315 278.827902l-21.192354 3.42968 10.135473-18.888837-9.828338-19.042405 21.089976 3.788006 15.100832-15.2544 2.917787 21.243543 19.144784 9.623581-19.298351 9.316445-3.224924 21.243544-14.844885-15.459157z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4407">
						</path>
						<path
							d="M407.620081 90.604991a486.861057 486.861057 0 0 1 504.521352 11.77353l25.031548-14.435371a511.892605 511.892605 0 0 0-797.528678 459.57718l25.031548-14.384182A486.758678 486.758678 0 0 1 407.620081 90.604991zM893.201406 933.333787a486.861057 486.861057 0 0 1-504.521351-11.619963l-24.980359 14.384183A511.892605 511.892605 0 0 0 1161.177185 476.572015L1136.401583 490.956197a486.912246 486.912246 0 0 1-243.200177 442.37759z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4408">
						</path>
						<path
							d="M813.909242 795.839433a326.587482 326.587482 0 0 1-258.147441 29.536203l-29.792149 17.199592a353.205897 353.205897 0 0 0 472.73282-272.429245l-29.792149 17.148403A326.843428 326.843428 0 0 1 813.909242 795.839433zM486.861057 228.099345a326.587482 326.587482 0 0 1 258.14744-29.536204l29.79215-17.199591A353.205897 353.205897 0 0 0 302.016637 453.792794l29.843339-17.148402a326.485103 326.485103 0 0 1 155.001081-208.545047zM1288.280119 374.705387a53.441588 53.441588 0 0 1-14.384182 11.978287l-1044.260914 601.934514a53.799913 53.799913 0 0 1-73.4054-19.759055L7.217686 710.660503a53.697534 53.697534 0 0 1 19.707865-73.405399L1071.442411 35.32059a53.799913 53.799913 0 0 1 73.4054 19.759054l148.80718 258.19863a53.953481 53.953481 0 0 1-5.374872 61.427113zM32.198045 665.716333a28.102904 28.102904 0 0 0-2.815409 32.146855l148.80718 258.19863a28.154093 28.154093 0 0 0 38.443134 10.237852L1261.149811 364.518724a28.154093 28.154093 0 0 0 10.237852-38.443135l-148.755991-258.249819a28.102904 28.102904 0 0 0-38.391945-10.237852L39.722866 659.420054a27.130308 27.130308 0 0 0-7.524821 6.296279z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4409">
						</path>
						<path
							d="M476.93034 500.938103l22.062571 38.289567-15.356778 8.804553-13.923479-24.058953-151.5714 87.584825 14.588939 25.133927-15.356778 8.855742-22.728032-39.364541L377.93031 557.962939c-6.091522-4.81179-11.415205-8.753364-15.868671-11.824719l14.947265-12.43899q5.989143 4.760601 17.097213 14.947264z m-17.046024 196.669139l-48.527419 28.000525 7.473632 12.899694-15.356778 8.804553-61.427112-105.961769 63.833007-36.856268-12.592558-21.857814L409.514084 573.319718l12.643747 21.857814L486.297975 557.962939l60.812841 105.347498-15.356778 8.855743-6.961739-11.82472-49.14169 28.358851 25.59463 44.381089-15.715103 9.060499zM414.63301 618.929349l-48.527419 28.000525 14.486561 25.133927 48.527419-28.000525zM388.526487 685.936091l14.53775 25.133927 48.527419-28.000526-14.53775-25.133927z m105.347498-79.496922l-14.48656-25.133927-49.397637 28.512418 14.742507 24.92917z m-26.567226 67.518635l49.192879-28.358851-14.53775-25.133927-49.14169 28.358851zM658.703404 641.094298l-15.356778 8.702175-63.218737-109.493828a300.839284 300.839284 0 0 1 7.524821 76.11843l-15.561535-12.387801a258.761712 258.761712 0 0 0-11.415205-96.542945l-29.536203 17.046023-8.702174-15.356778 30.201663-17.404348-24.622034-42.640654 15.049643-8.702175 24.622034 42.640654 25.59463-14.896075 8.702174 15.049643-25.59463 14.896075 8.241471 14.230614q24.673224 8.446228 55.489158 22.420896l-1.023785 18.376945q-28.717175-16.380563-44.637035-23.751817z m27.079119-17.660294l-16.380564-8.650985a225.232746 225.232746 0 0 0 59.379543-163.805634l17.404348-0.71665a249.752402 249.752402 0 0 1-7.6272 72.586372 377.008904 377.008904 0 0 1 64.191333 18.325755l-4.81179 17.916241a350.28811 350.28811 0 0 0-63.67944-20.936407 244.121583 244.121583 0 0 1-48.322662 85.281308z m-97.669109-176.756517l54.618941-31.532584a164.266337 164.266337 0 0 0-22.983978-15.356779l14.691318-11.927097a287.171751 287.171751 0 0 1 23.598249 18.68408L706.411795 378.288635l8.190281 14.179425-59.891434 34.60394c0.307136 28.41004-1.586867 49.602393-5.52844 63.525873 17.353159-11.568773 30.713556-20.475704 39.620487-26.669605a194.51919 194.51919 0 0 0 0.870218-33.426587L706.411795 429.989788q4.709412 84.359901-44.944171 144.251336l-16.124617-8.190281a182.233767 182.233767 0 0 0 40.951408-82.517088q-27.488633 17.916241-47.554823 30.713556l-10.698555-11.005691 1.586867-1.586867 0.921407-1.433299q8.139092-15.766292 8.395038-63.73063L596.303695 460.703344zM805.155878 288.144347l16.175807-9.367634 22.728031 39.364541 78.473137-45.302496 59.328353 102.736846-15.766293 9.060499-7.934335-13.769911-62.706844 36.241997 42.998979 74.531563-16.175807 9.316445-42.998979-74.531563-62.553276 36.088429 7.985525 13.769911-15.91986 9.111688-59.123596-102.736846 78.21719-45.046549z m2.76422 149.063127l62.502087-35.832482L836.739652 342.968045l-62.502087 35.832483z m78.677894-45.404874l62.706844-36.241997-33.682534-58.355757-62.706844 36.241997z"
							fill="rgb(242, 94, 67)" opacity=".5" p-id="4410">
						</path>
					</svg>
				</div>
			</el-row>
			<el-card>
				<div class="block" style="background: #fff">
					<el-timeline>
						
					
						<el-timeline-item v-for="(activity, index) in splist" 
							:key="index" 
							:type="activity.type"
							:color="index==splist.length-1?'#0bbd87':''" 
							:timestamp="'审批时间：'+activity.flowSpTime  ">
							<p>{{ activity.archivesEmpsp.empName+'('+activity.workflowNode.alinkey.alinkeyName+')'}}</p>
							<template v-if="activity.flowSpTime!= '(ง •̀_•́)ง...' ">
								<p><time class="time">提交意见：</time>{{ activity.flowSpRemarks }}</p>
							</template>
							<template v-else>
								<p><time class="time">等待审批中</time></p>
							</template>
							
						</el-timeline-item>
						
						
						
					</el-timeline>
				</div>
			</el-card>
			<el-row>
				<el-col :span="24">
					<div class="grid-content bg-purple">
						<div class="mstz">审批节点</div>
					</div>
				</el-col>
			</el-row>
			<el-card>
				<div class="block" style="height: 105px;background: #fff;width: 500px;">
					<el-steps direction="vertical">
						<el-step :title="n.alinkey.alinkeyName" v-for="n in approveform" :key="n.alinkey.alinkeyId">
						</el-step>
					</el-steps>
				</div>
			</el-card>
		</el-col>

	</el-drawer>
	

</template>

<script lang="ts">
	import qs from 'qs'
	import {
		Timer
	} from '@element-plus/icons'

	export default {
		components: {
			Timer,
		},
		data() {
			return {
				ins:{},
				splist: [],
				approveform: '',
				drawer: false,
				innerDrawer: false,
				pageno: 1,
				pagesize: 5,
				total: 0,
				query: {
					name: ''
				},
				tableData: [],
			}
		},
		methods: { 
			rowClick(index, row) {
				console.log(row);
				try {
					this.$router.push({
						name: row.approve_flow.flowUrl,
						params: {
							table: row.approveId,
							approveId:row.approve_flow.flowId,
							node:row.workflowNode.nodeId
						}
					});
				} catch (err) {
					this.$router.replace("/404");
				}
			},
			SelectHistory(val) {
				let prim = {
					id: val.approveId
				};
				let qsprim = qs.stringify(prim);
				this.axios.post("approve/selectid", qsprim).then(res => {
					if (res.code == 1) {
						console.log("这里结果是啥",res.obj);
						this.ins=res.obj.approveState;
						this.splist = res.obj.spList;
						this.splist.forEach(re=>{
							if(re.flowSpTime==null){
								re.flowSpTime="(ง •̀_•́)ง..."
							}
						})
						
					}
				})
			},
			search() {
				this.selectall();
			},
			handleSizeChange(val) {
				this.pagesize = val;
				this.selectall();
			},
			handleCurrentChange(val) {
				this.pageno = val;
				this.selectall();
			},
			handleEdit(index, row) {
				this.drawer = true;
				let prim = {
					id: row.approve_flow.flowId
				};
				let qsprim = qs.stringify(prim);
				this.axios.post("node/selectid", qsprim).then(res => {
					if (res.code == 1) {
						this.approveform = res.data;
						this.SelectHistory(row);
					}
				})


			},
			selectall() {
				let PrimName = {
					no: this.pageno,
					size: this.pagesize,
					name: this.query.name
				};
				this.axios.post("approve/all", PrimName).then(res => {
					this.tableData = res.obj.list;;
					this.total = res.obj.total;
					this.pageno = res.obj.pageNum;
					this.pagesize = res.obj.pageSize;
				})
			}
		},
		created() {
			this.selectall();
		}
	}
</script>

<style scoped>
	>>>.el-table .cell {
		text-align: center;
	}

	>>>.el-input.is-disabled .el-input__inner,
	>>>.el-textarea.is-disabled .el-textarea__inner {
		background-color: #fff;
		color: #606266;
		cursor: inherit;
	}

	.mstz {
		margin: 10px 0px;
		background-color: #fff;
		padding: 10px 20px;
		/*text-align: center;*/
		color: #20A0FF;
	}

	.sq1 .formstyle {
		padding: 30px 50px;
		background-color: #fff;
		width: 100%;
	}

	.sq2 .formstyle {
		padding: 30px 50px;
		background-color: #fff;
	}

	.lssq>>>.el-button--primary.is-plain:focus,
	.lssq>>>.el-button--primary.is-plain:hover {
		background-color: #b3d8ff;
		border: #b3d8ff 1px solid;
	}

	.ck>>>.el-textarea.is-disabled .el-textarea__inner,
	.toexamine>>>.el-textarea.is-disabled .el-textarea__inner {
		background-color: #fff;
		color: #606266;
		cursor: inherit;
		border-bottom-color: #606266;
		border-top-color: #fff;
		border-right-color: #fff;
		border-left-color: #fff;
	}

	.ck>>>.el-input.is-disabled .el-input__inner,
	.toexamine>>>.el-input.is-disabled .el-input__inner {
		background-color: #fff;
		color: #606266;
		cursor: inherit;
		border-bottom-color: #606266;
		border-top-color: #fff;
		border-right-color: #fff;
		border-left-color: #fff;
	}

	.spstate {
		width: 100px;
		height: 100px;
		position: absolute;
		top: 10px;
		left: 200px;
	}

	.gotop {
		position: fixed;
		bottom: 50px;
		right: 20px;
		height: 40px;
		width: 40px;
		background-color: #20A0FF;
		box-shadow: 0 0 6px rgba(0, 0, 0, .12);
		text-align: center;
		line-height: 40px;
		color: #fff;
		border-radius: 50%;
		cursor: pointer;
	}

	.gotop:hover {
		background-color: #89c6f5;
	}

	.toexamine>>>.el-input--prefix,
	.toexamine>>>.el-input--suffix .el-input__inner {
		width: 21vw;
	}

	.cc>>>.el-input--prefix,
	.cc>>>.el-input--suffix .el-input__inner {
		width: 455px;
	}

	.el-timeline-item__wrapper {
		position: relative;
		padding-left: 28px;
		top: -5px;
	}
</style>
